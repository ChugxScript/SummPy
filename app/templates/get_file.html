<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/get_file.css') }}">
    <title>SummPy | 5-pager Summarizer</title>
</head>
<body>

    <header class="header">
        <a href="{{ url_for('home.home_page') }}" class="logo">
            <img src="{{ url_for('static', filename='images/LOGO.gif') }}" alt="Logo" class="logo-img">
        </a>
        

        <nav class="navbar">
            <a href="{{url_for('home.home_page')}}">HOME</a>
            <a href="{{url_for('about.about_page')}}">HOW TO USE</a>
            <a href="{{url_for('get_started.get_started_page')}}">ABOUT US</a>
            <a href="{{url_for('donate.donate_page')}}">DONATE</a>
        </nav>
    </header>

<div class="whole">

            <!-- 1st section -->
            <div class="first">
                <div class="text-container" style="padding-left: 0;">
                    <p class="neon-text" style="font-weight: bold; color: white; white-space: nowrap; margin-left: 0;">
                        <span style="color: #500079;">UPLOAD</span> YOUR DOCUMENT
                    </p>
                </div>
            
            <!-- end -->
             
        <form action="{{ url_for('get_file.get_file_page') }}" method="POST" enctype="multipart/form-data">
            <div class="upload-box" id="upload-box">
                <span>Select or Drop a file</span>
                <h3>We support .pdf, .doc, .docx files up to 100 MB</h3>
                <input type="file" id="file-input" name="file" required>
            </div>
        </form>
    
        <!-- show the uploaded file here -->
        {% if uploaded_files %}
        <div class="uploaded-file">
            <h2>Uploaded File:</h2>
            <ul>
                {% for file in uploaded_files %}
                <li><a href="{{ url_for('static', filename='uploads/' ~ file) }}" target="_blank">{{ file }}</a></li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    
            <button onclick="redirect_to_next_page()" class="now" id="summarize">SUMMARIZE</button>
    
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const fileInput = document.getElementById('file-input');
                check_uploaded_files();
    
                fileInput.addEventListener('change', function() {
                    if (fileInput.files.length > 0) {   
                        // Auto-submit the form
                        this.form.submit();
                    } 
                });
    
                // Display flash messages as alerts
                const flashMessage = "{{ get_flashed_messages()[0] }}";
                if (flashMessage) {
                    alert(flashMessage);
                }
            });
    
            function check_uploaded_files(){
                const uploadedFiles = JSON.parse('{{ uploaded_files|tojson|safe }}');
                const submitButton = document.getElementById('summ-btn');
                if (uploadedFiles.length > 0) {
                    console.log("Uploaded files:", uploadedFiles);
                    submitButton.style.backgroundColor = '#c4ff00';
                    submitButton.disabled = false;
                } else {
                    submitButton.style.backgroundColor = '#e26890';
                    submitButton.disabled = true;
                }
            }
    
            function redirect_to_next_page(){
                window.location.href = "{{ url_for('get_file_pages.get_file_pages_page') }}";
            }
        </script>

    </div>
</div>

    <img class="dot" src="{{ url_for('static', filename='images/polka.png') }}">
    <img class="dot2" src="{{ url_for('static', filename='images/polka.png') }}">

</body>
</html>
